
# **Nota de Aula: Avaliação de Modelos de Regressão**

## 1. Introdução às Métricas de Avaliação

Vamos falar sobre a avaliação de modelos, focando em duas medidas importantes: o Erro Quadrático Médio (MSE) e o R-quadrado.

O **Erro Quadrático Médio (MSE)** é uma forma de medir o quão bem um modelo se ajusta aos dados. Imagine que você está tentando adivinhar a altura de várias pessoas. Se você adivinha 150 cm, mas a altura real é 160 cm, a diferença é 10 cm. Para calcular o MSE, você pega essa diferença, eleva ao quadrado (para que não haja números negativos) e depois faz isso para todas as adivinhações, somando tudo e dividindo pelo número total de pessoas. Isso te dá uma ideia de quão longe suas adivinhações estão da realidade, em média.

O **R-quadrado**, por outro lado, é uma medida que nos diz o quanto do comportamento dos dados é explicado pelo nosso modelo. Pense nele como uma comparação entre o seu modelo e a média dos dados. Se o seu modelo é muito melhor do que simplesmente usar a média, o R-quadrado será próximo de 1. Se não for, ele ficará mais perto de 0. Isso ajuda a entender se o modelo realmente captura as tendências dos dados ou se está apenas "chutando".

O resumo sobre a avaliação de modelos inclui duas medidas principais: Erro Quadrático Médio (MSE) e R-quadrado.

**Erro Quadrático Médio (MSE)**
- Mede a precisão do modelo comparando os valores reais com os valores previstos.
- Calcula a média das diferenças ao quadrado entre os valores reais e previstos, fornecendo uma ideia de quão bem o modelo se ajusta aos dados.

**R-quadrado**
- Indica a proporção da variação nos dados que é explicada pelo modelo.
- Um valor próximo de 1 significa que o modelo é bom em prever os dados, enquanto um valor próximo de 0 indica que o modelo não é melhor do que usar a média dos dados.

Essas medidas ajudam a avaliar a eficácia de modelos preditivos em análise de dados.

---

## 2. Perguntas e Respostas

Esta seção consolida todas as perguntas e respostas presentes no material original para fácil consulta.

### **O que é Erro Quadrático Médio (MSE)? Como é utilizado para avaliar o modelo?**
O **Erro Quadrático Médio (MSE)** é uma métrica utilizada para avaliar a precisão de um modelo preditivo. Ele mede a média das diferenças ao quadrado entre os valores reais e os valores previstos pelo modelo. Aqui está como funciona:

#### Cálculo do MSE:
1.  **Diferença**: Para cada ponto de dados, calcule a diferença entre o valor real (y) e o valor previsto (ŷ).
2.  **Quadrado**: Eleve essa diferença ao quadrado para eliminar valores negativos.
3.  **Média**: Some todos os quadrados das diferenças e divida pelo número total de pontos de dados.

A fórmula do MSE é:
\[ \text{MSE} = \frac{1}{n} \sum_{i=1}^{n} (y_i - \hat{y}_i)^2 \]
onde:
- \( n \) é o número total de observações,
- \( y_i \) é o valor real,
- \( \hat{y}_i \) é o valor previsto.

#### Utilização do MSE para Avaliar o Modelo:
- **Menor é Melhor**: Um MSE menor indica que o modelo está fazendo previsões mais precisas. Se o MSE for alto, isso sugere que o modelo não está se ajustando bem aos dados.
- **Comparação de Modelos**: O MSE pode ser usado para comparar diferentes modelos. O modelo com o menor MSE é geralmente considerado o melhor.
- **Identificação de Problemas**: Um MSE muito alto pode indicar problemas como overfitting (quando o modelo se ajusta demais aos dados de treinamento) ou underfitting (quando o modelo não captura a complexidade dos dados).

### **O que é R-quadrado? Como é utilizado para avaliar o modelo?**
O **R-quadrado** (ou coeficiente de determinação) é uma métrica que indica a proporção da variação nos dados que é explicada por um modelo de regressão. Ele fornece uma ideia de quão bem o modelo se ajusta aos dados observados.

#### Cálculo do R-quadrado:
O R-quadrado é calculado da seguinte forma:
1.  **MSE do Modelo**: Calcule o Erro Quadrático Médio (MSE) do modelo de regressão.
2.  **MSE da Média**: Calcule o MSE da média dos dados (ou seja, a média dos valores reais).
3.  **R-quadrado**: Use a fórmula:
    \[ R^2 = 1 - \frac{\text{MSE do Modelo}}{\text{MSE da Média}} \]

#### Interpretação do R-quadrado:
- **Valores entre 0 e 1**: O R-quadrado varia de 0 a 1.
  - **R² = 1**: O modelo explica 100% da variação nos dados, indicando um ajuste perfeito.
  - **R² = 0**: O modelo não explica nenhuma variação, sendo equivalente a usar a média dos dados.
- **Valores Negativos**: Um R-quadrado negativo pode ocorrer em casos de overfitting, onde o modelo se ajusta mal aos dados.

#### Utilização do R-quadrado para Avaliar o Modelo:
- **Avaliação de Ajuste**: Um R-quadrado mais alto indica que o modelo é melhor em prever os dados. Isso sugere que o modelo captura as tendências dos dados de forma eficaz.
- **Comparação de Modelos**: O R-quadrado pode ser usado para comparar diferentes modelos de regressão. O modelo com o maior R-quadrado é geralmente preferido.
- **Limitações**: Embora útil, o R-quadrado não deve ser a única métrica utilizada. Ele não indica se o modelo é adequado ou se as suposições do modelo foram atendidas.

### **Como o R-quadrado se relaciona com o MSE?**
O **R-quadrado** e o **Erro Quadrático Médio (MSE)** são duas métricas que ajudam a avaliar a qualidade de um modelo de regressão, mas elas medem aspectos diferentes do ajuste do modelo.

#### Relação entre R-quadrado e MSE:
1.  **Medição de Erro vs. Proporção de Variação**:
    - **MSE** mede o erro absoluto do modelo, calculando a média das diferenças ao quadrado entre os valores reais e os valores previstos. Um MSE menor indica previsões mais precisas.
    - **R-quadrado** mede a proporção da variação nos dados que é explicada pelo modelo. Um R-quadrado mais alto indica que o modelo captura melhor a variação dos dados.
2.  **Cálculo**:
    - O R-quadrado é calculado usando o MSE do modelo e o MSE da média dos dados. A fórmula é:
      \[ R^2 = 1 - \frac{\text{MSE do Modelo}}{\text{MSE da Média}} \]
    Isso mostra que o R-quadrado é diretamente influenciado pelo MSE do modelo. Se o MSE do modelo for baixo em relação ao MSE da média, o R-quadrado será alto.
3.  **Interpretação**:
    - Um **MSE baixo** geralmente resulta em um **R-quadrado alto**, indicando que o modelo está fazendo previsões precisas e explicando bem a variação nos dados.
    - No entanto, um **R-quadrado alto** não garante que o MSE seja baixo, especialmente se o modelo estiver overfitting (ajustando-se demais aos dados de treinamento).

#### Conclusão:
Ambas as métricas são importantes para avaliar um modelo, mas devem ser usadas em conjunto para obter uma visão completa do desempenho do modelo. O MSE fornece uma medida direta do erro, enquanto o R-quadrado oferece uma perspectiva sobre a eficácia do modelo em explicar a variação dos dados.

### **Como o R-quadrado pode ser interpretado em um modelo?**
A interpretação do **R-quadrado** em um modelo de regressão é fundamental para entender a eficácia do modelo em explicar a variação dos dados. Aqui estão algumas maneiras de interpretar o R-quadrado:

#### Interpretação do R-quadrado:
1.  **Proporção da Variação Explicada**:
    - O R-quadrado indica a proporção da variação na variável dependente que é explicada pelo modelo. Por exemplo, um R² de 0,80 significa que **80% da variação** nos dados é explicada pelo modelo, enquanto os **20% restantes** são atribuídos a fatores não incluídos no modelo ou ao erro.
2.  **Comparação entre Modelos**:
    - O R-quadrado pode ser usado para comparar diferentes modelos de regressão. Um modelo com um R-quadrado mais alto é geralmente considerado melhor em termos de ajuste aos dados. No entanto, é importante garantir que os modelos sejam comparáveis (por exemplo, ambos devem ser ajustados aos mesmos dados).
3.  **Limites do R-quadrado**:
    - Um R-quadrado alto não garante que o modelo seja o melhor. É possível que um modelo com um R² elevado esteja overfitting, ou seja, ajustando-se demais aos dados de treinamento e não generalizando bem para novos dados.
    - Um R-quadrado baixo não significa necessariamente que o modelo é inútil. Em alguns casos, a variável dependente pode ser intrinsecamente difícil de prever.
4.  **Valores Negativos**:
    - Em casos raros, o R-quadrado pode ser negativo, o que indica que o modelo é pior do que simplesmente usar a média dos dados. Isso geralmente ocorre em situações de overfitting ou quando o modelo é mal especificado.
5.  **Contexto do Domínio**:
    - A interpretação do R-quadrado também deve levar em conta o contexto do domínio. Em algumas áreas, como ciências sociais, um R-quadrado de 0,30 pode ser considerado aceitável, enquanto em outras, como engenharia, um R-quadrado de 0,90 pode ser esperado.

#### Conclusão:
O R-quadrado é uma métrica valiosa para avaliar a qualidade do ajuste de um modelo de regressão, mas deve ser interpretado com cautela e em conjunto com outras métricas e considerações contextuais.

### **Exemplos da Vida Real da Interpretação do R-quadrado**
Aqui estão alguns exemplos da vida real que ilustram como o **R-quadrado** pode ser interpretado em diferentes contextos:

1.  **Vendas de Produtos**:
    - **Contexto**: Uma empresa de varejo deseja prever as vendas mensais de um produto com base em variáveis como preço, gastos com marketing e sazonalidade.
    - **Interpretação do R-quadrado**: Se o modelo de regressão resultar em um R² de 0,85, isso significa que **85% da variação nas vendas** pode ser explicada pelas variáveis incluídas no modelo. Isso sugere que o modelo é bastante eficaz em prever vendas, mas ainda há 15% da variação que não é explicada, possivelmente devido a fatores como mudanças nas preferências dos consumidores.
2.  **Desempenho Acadêmico**:
    - **Contexto**: Uma escola está analisando o impacto de horas de estudo, frequência às aulas e participação em atividades extracurriculares no desempenho dos alunos em testes.
    - **Interpretação do R-quadrado**: Um R² de 0,70 indica que **70% da variação nas notas dos alunos** pode ser explicada por essas variáveis. Isso sugere que, embora o modelo capture uma boa parte da variação, outros fatores, como motivação ou ambiente familiar, também podem influenciar o desempenho.
3.  **Previsão de Preços de Imóveis**:
    - **Contexto**: Uma empresa imobiliária utiliza um modelo de regressão para prever os preços de imóveis com base em características como localização, tamanho e número de quartos.
    - **Interpretação do R-quadrado**: Se o R² for 0,90, isso significa que **90% da variação nos preços dos imóveis** é explicada pelas características do imóvel. Isso sugere que o modelo é muito eficaz, mas ainda há 10% da variação que pode ser atribuída a fatores não considerados, como condições de mercado ou características únicas de cada imóvel.
4.  **Análise de Dados de Saúde**:
    - **Contexto**: Pesquisadores estão estudando a relação entre a atividade física e a pressão arterial em um grupo de indivíduos.
    - **Interpretação do R-quadrado**: Um R² de 0,50 indica que **50% da variação na pressão arterial** pode ser explicada pela quantidade de atividade física. Isso sugere que, embora a atividade física tenha um impacto significativo, outros fatores, como dieta e genética, também desempenham um papel importante.

# Pratica

Aqui está um guia completo de como usar o **Erro Quadrático Médio (MSE)** e o **R-quadrado (R²)** em Python, utilizando a biblioteca `scikit-learn`, que é o padrão da indústria para isso.

### Exemplo Completo em Python

Vamos criar um cenário simples:
1.  Gerar dados com uma relação linear e um pouco de ruído.
2.  Treinar um modelo de Regressão Linear.
3.  Avaliar o modelo usando MSE e R-quadrado.

```python
# Passo 1: Importar as bibliotecas necessárias
import numpy as np
import matplotlib.pyplot as plt
from sklearn.linear_model import LinearRegression
from sklearn.metrics import mean_squared_error, r2_score

# Passo 2: Criar dados de exemplo (simulados)
# Vamos criar dados onde a relação é y = 2x + 5 + ruído
np.random.seed(42) # Para garantir que os resultados sejam reprodutíveis
X = np.linspace(0, 10, 100).reshape(-1, 1) # Variável independente (100 pontos)
y_real = 2 * X.flatten() + 5 # A relação linear verdadeira
ruido = np.random.normal(0, 2, 100) # Adicionando ruído aleatório
y = y_real + ruido # Variável dependente final (com ruído)

# Passo 3: Criar e treinar o modelo de Regressão Linear
modelo = LinearRegression()
modelo.fit(X, y)

# Passo 4: Fazer previsões com o modelo treinado
y_previsto = modelo.predict(X)

# Passo 5: Calcular as métricas de avaliação
# Erro Quadrático Médio (MSE)
mse = mean_squared_error(y, y_previsto)

# R-quadrado (R²)
r2 = r2_score(y, y_previsto)

# (Opcional) Raiz do Erro Quadrático Médio (RMSE) - mais fácil de interpretar
rmse = np.sqrt(mse)

# Passo 6: Exibir os resultados
print("--- Métricas de Avaliação do Modelo ---")
print(f"Erro Quadrático Médio (MSE): {mse:.2f}")
print(f"Raiz do Erro Quadrático Médio (RMSE): {rmse:.2f}")
print(f"R-quadrado (R²): {r2:.2f}")
print("---------------------------------------")

# Passo 7: Visualizar os resultados
plt.figure(figsize=(10, 6))
plt.scatter(X, y, color='blue', label='Dados Originais (com ruído)', alpha=0.7)
plt.plot(X, y_previsto, color='red', linewidth=2, label='Linha de Regressão (Modelo)')
plt.title('Regressão Linear e Avaliação do Modelo')
plt.xlabel('Variável Independente (X)')
plt.ylabel('Variável Dependente (y)')
plt.legend()
plt.grid(True)
plt.show()

```

### Explicação Detalhada do Código e das Métricas

#### 1. Erro Quadrático Médio (MSE)

- **Como usar**: `mean_squared_error(y_reais, y_previstos)`
  - O primeiro argumento (`y`) são os valores verdadeiros.
  - O segundo argumento (`y_previsto`) são os valores que o seu modelo previu.

- **Interpretação do Resultado**:
  - O MSE nos dá um número que representa a média dos erros ao quadrado. No nosso exemplo, um `MSE` de `3.55` significa que, na média, o quadrado da diferença entre o valor real e o previsto é 3.55.
  - **Quanto menor o MSE, melhor o modelo.**
  - A unidade do MSE é a unidade da variável alvo ao quadrado (ex: R$², metros²), o que pode ser difícil de interpretar. Por isso, muitas vezes usamos a **Raiz do Erro Quadrático Médio (RMSE)**.

#### 2. Raiz do Erro Quadrático Médio (RMSE)

- **Como usar**: `np.sqrt(mean_squared_error(y_reais, y_previstos))`
  - Simplesmente tiramos a raiz quadrada do MSE.

- **Interpretação do Resultado**:
  - O RMSE tem a mesma unidade que a variável alvo (ex: R$, metros).
  - No nosso exemplo, um `RMSE` de `1.88` significa que, em média, as previsões do modelo erram por aproximadamente 1.88 unidades da variável `y`. Isso é muito mais intuitivo.

#### 3. R-quadrado (R²)

- **Como usar**: `r2_score(y_reais, y_previstos)`
  - Os argumentos são os mesmos do MSE.

- **Interpretação do Resultado**:
  - O R-quadrado nos diz qual a porcentagem da variação dos dados que o nosso modelo consegue explicar.
  - No nosso exemplo, um `R²` de `0.91` é excelente! Significa que **91% da variabilidade** na variável `y` é explicada pelo nosso modelo de regressão linear. Os 9% restantes são devidos a fatores não capturados pelo modelo (no nosso caso, o ruído que adicionamos propositalmente).
  - **Quanto mais próximo de 1, melhor o modelo.**
    - `R² = 1`: O modelo explica toda a variabilidade.
    - `R² = 0`: O modelo não explica nada melhor do que simplesmente usar a média dos dados.
    - `R² < 0`: O modelo é pior do que usar a média (geralmente um sinal de que algo está muito errado).
----
Com certeza! A transcrição que você enviou é de uma aula que fala sobre um passo crucial em machine learning: **como saber se o seu modelo é bom?**

A explicação no vídeo é um pouco corrida e salta entre diferentes ideias. Vou reorganizar e explicar os conceitos de forma mais clara, seguindo uma ordem lógica.

---

# **Explicação Detalhada da Aula: Avaliando seu Modelo de Regressão**

A aula aborda três formas principais de avaliar um modelo, que você deve sempre usar em conjunto:

1.  **Análise de Previsões e Coeficientes:** Verificar se os resultados do modelo fazem sentido no mundo real.
2.  **Análise Visual:** Usar gráficos para "ver" o comportamento do modelo e seus erros.
3.  **Análise Numérica:** Usar métricas como MSE e R-quadrado para quantificar o desempenho.

Vamos detalhar cada uma dessas partes.

---

#### **Parte 1: Análise de Previsões e Coeficientes (O Teste do "Bom Senso")**

Depois de treinar o modelo, a primeira coisa a fazer é usá-lo e ver se os resultados são lógicos.

*   **Fazendo uma Previsão:**
    *   **Exemplo do vídeo:** O modelo foi treinado para prever o `preço` de um carro com base em seu consumo na estrada (`highway-mpg`).
    *   **Pergunta:** Qual o preço de um carro que faz 30 milhas por galão?
    *   **Resposta do modelo:** `$13.771,30`.
    *   **Conclusão da aula:** Esse valor "parece fazer sentido". Não é negativo, nem absurdamente alto ou baixo. É um primeiro sinal positivo.

*   **Interpretando os Coeficientes do Modelo:**
    *   O modelo linear tem uma fórmula: `preço = (coeficiente * highway-mpg) + intercepto`.
    *   **Exemplo do vídeo:** O coeficiente encontrado para `highway-mpg` foi de aproximadamente **-821**.
    *   **Interpretação:** Isso significa que, para cada aumento de **1 unidade** em `highway-mpg` (o carro se torna mais econômico), o preço do carro **diminui em aproximadamente $821**.
    *   **Conclusão da aula:** Isso também "parece razoável". Geralmente, carros mais econômicos (maior `mpg`) tendem a ser mais baratos.

*   **Identificando Limitações:**
    *   **Exemplo do vídeo:** E se pedirmos ao modelo para prever o preço de carros com `highway-mpg` entre 0 e 100?
    *   **Resultado:** O modelo começa a prever **preços negativos**, o que é impossível.
    *   **Por que isso acontece?** O modelo só aprendeu com os dados que tinha (carros com consumo realista, talvez entre 15 e 50 mpg). A suposição de que a relação é uma linha reta (linear) não funciona para valores tão extremos. Isso mostra os limites do seu modelo.

---

#### **Parte 2: Análise Visual (Usando Gráficos para Diagnosticar Problemas)**

Visualizar é a forma mais rápida de entender o desempenho do seu modelo.

*   **Gráfico de Regressão:**
    *   **O que é?** Um gráfico que plota seus dados originais (pontos) e a linha de previsão do seu modelo.
    *   **Para que serve?** Para ver se a linha se ajusta bem aos pontos. No exemplo, a aula menciona que, apesar de uma tendência de queda, o gráfico mostra um "comportamento não linear", sugerindo que uma curva (regressão polinomial) poderia ser melhor que uma linha reta.

*   **Gráfico de Resíduos:**
    *   **O que é?** Resíduos são os erros (a diferença entre o valor real e o valor previsto). Este gráfico mostra esses erros.
    *   **Para que serve?** Se os erros formam um padrão (como uma curva), isso é um sinal de alerta.
    *   **Conclusão da aula:** O gráfico de resíduos do exemplo tinha uma "curvatura", o que **confirma que um modelo linear não é o ideal** para aqueles dados.

*   **Gráfico de Distribuição:**
    *   **O que é?** Compara a distribuição dos valores previstos com a distribuição dos valores reais.
    *   **Para que serve?** Ideal para Regressão Linear Múltipla. Ajuda a ver em quais faixas de preço o modelo é mais ou menos preciso.
    *   **Conclusão da aula:** O gráfico mostrou que as previsões para carros na faixa de $30.000 a $50.000 eram imprecisas, sugerindo a necessidade de um modelo melhor ou de mais dados nessa faixa.

---

#### **Parte 3: Análise Numérica (Medindo o Desempenho com MSE e R²)**

Depois de analisar visualmente, usamos números para ter uma medida objetiva.

*   **Erro Quadrático Médio (MSE):**
    *   **O que mede?** O tamanho médio do erro do seu modelo.
    *   **Interpretação:** **Quanto menor o MSE, melhor.** Um MSE alto significa que as previsões estão, em média, muito longe dos valores reais.
    *   **Exemplo do vídeo:** A aula mostra 3 gráficos. À medida que o MSE aumenta (de 3.495 para 12.870), os pontos de dados ficam visivelmente mais distantes da linha de previsão.

*   **R-Quadrado (R²):**
    *   **O que mede?** A porcentagem da variação nos seus dados que o modelo consegue explicar.
    *   **Interpretação:** **Quanto mais próximo de 1 (ou 100%), melhor.**
        *   `R² = 0.99`: O modelo explica 99% da variação. Ajuste quase perfeito.
        *   `R² = 0.61`: O modelo explica 61% da variação. A relação é mais fraca e os dados são mais "confusos".
    *   **Contexto é tudo:** Um R² "aceitável" varia muito. Em física, pode-se esperar `R² > 0.95`. Em ciências sociais, `R² = 0.30` pode ser considerado significativo.

---

#### **Parte 4: A Armadilha Final (Comparando Modelos Diferentes)**

O vídeo termina com um aviso importante.

*   **Pergunta:** Um MSE menor ou um R² maior sempre significa um modelo melhor?
*   **Resposta:** **NÃO, NECESSARIAMENTE.**

*   **A Armadilha:**
    *   Se você adicionar mais variáveis ao seu modelo (por exemplo, passar de uma Regressão Linear Simples para uma Múltipla), o **MSE quase sempre diminuirá e o R² quase sempre aumentará.**
    *   Isso acontece mesmo que as novas variáveis sejam inúteis! O modelo simplesmente tem mais "informação" para se ajustar aos dados de treinamento, mas isso não significa que ele fará previsões melhores com dados novos.

*   **Conclusão da Aula:** Por causa dessa armadilha, o vídeo sugere que existem **"maneiras melhores de avaliar o modelo"**, que serão vistas em aulas futuras. (Ele está se referindo a técnicas como **R-quadrado ajustado**, **validação cruzada** e outras métricas que penalizam a complexidade desnecessária do modelo).

-----
## Prática

Vou criar um exemplo completo em Python que:
1.  Usa dados simulados parecidos com o exemplo da aula (preço de carros vs. consumo).
2.  Treina um modelo de Regressão Linear.
3.  Gera os **três gráficos** citados na aula: o Gráfico de Regressão, o Gráfico de Resíduos e o Gráfico de Distribuição.

Para os gráficos, usaremos a biblioteca **Seaborn**, que é construída sobre o Matplotlib e torna a criação desses gráficos estatísticos muito mais simples e bonita.

### Passo a Passo: Criando os Gráficos de Avaliação em Python

Primeiro, vamos preparar nosso ambiente, dados e modelo.

```python
# --- Passo 1: Importar as bibliotecas ---
import numpy as np
import pandas as pd
import matplotlib.pyplot as plt
import seaborn as sns
from sklearn.linear_model import LinearRegression

# --- Passo 2: Criar dados simulados ---
# Vamos simular dados de carros, onde o preço (y) diminui com o consumo (X),
# mas com uma leve curvatura e algum ruído, como na vida real.
np.random.seed(42) # Para resultados reprodutíveis
X = np.linspace(15, 50, 100) # Consumo (highway-mpg) de 15 a 50
# Relação: preço base de 40k, diminui com mpg, com uma leve curva (termo quadrático) e ruído
y = 40000 - 800 * X - 5 * (X - 15)**2 + np.random.normal(0, 2000, 100)

# Converter para o formato que o scikit-learn espera
X = X.reshape(-1, 1)

# --- Passo 3: Treinar um modelo de Regressão Linear Simples ---
modelo = LinearRegression()
modelo.fit(X, y)

# --- Passo 4: Fazer as previsões ---
y_previsto = modelo.predict(X)

print("Setup concluído! Agora vamos criar os gráficos.")
```

Agora que temos tudo pronto (`y` são os preços reais e `y_previsto` são os preços previstos pelo modelo), vamos criar cada gráfico.

---

### Gráfico 1: Gráfico de Regressão

Este gráfico nos ajuda a ver visualmente como a linha do nosso modelo se ajusta aos dados originais.

**O que ele mostra:** Os pontos de dados reais e a linha de previsão do modelo.

```python
# --- Gráfico 1: Gráfico de Regressão ---
plt.figure(figsize=(10, 6))

# O seaborn.regplot faz o gráfico de dispersão e a linha de regressão em um só comando
sns.regplot(x=X, y=y, scatter_kws={'alpha':0.6, 'color': 'blue'}, line_kws={'color': 'red', 'linewidth': 2}, label='Linha de Regressão')

plt.title('Gráfico de Regressão: Preço vs. Consumo (MPG)')
plt.xlabel('Consumo na Estrada (Highway-MPG)')
plt.ylabel('Preço do Carro ($)')
plt.legend(['Dados Originais', 'Linha de Regressão do Modelo'])
plt.grid(True)
plt.show()
```

**Interpretação (como na aula):**
Podemos ver que a linha vermelha (nosso modelo) captura a tendência geral de que o preço cai conforme o consumo (MPG) aumenta. No entanto, os pontos azuis parecem formar uma leve curva, sugerindo que o modelo linear não é perfeito.

---

### Gráfico 2: Gráfico de Resíduos

Este é um dos gráficos de diagnóstico mais importantes. Ele nos ajuda a ver se os erros do modelo têm algum padrão.

**O que ele mostra:** Os erros (resíduos) do modelo em relação à variável independente.

```python
# --- Gráfico 2: Gráfico de Resíduos ---
plt.figure(figsize=(10, 6))

# O seaborn.residplot calcula e plota os resíduos automaticamente
sns.residplot(x=X.flatten(), y=y, color='green')

plt.title('Gráfico de Resíduos')
plt.xlabel('Consumo na Estrada (Highway-MPG)')
plt.ylabel('Resíduos (Erro: Real - Previsto)')
plt.axhline(0, color='red', linestyle='--', linewidth=2) # Linha em y=0 para referência
plt.grid(True)
plt.show()
```

**Interpretação (como na aula):**
Exatamente como a aula descreveu! Os resíduos **não estão aleatoriamente espalhados** em torno da linha vermelha (erro zero). Eles formam um padrão de **curva** (uma parábola invertida). Isso é um sinal claro de que a relação entre os dados não é puramente linear, e um modelo mais complexo (como a Regressão Polinomial) seria mais apropriado.

---

### Gráfico 3: Gráfico de Distribuição

Este gráfico compara a distribuição dos valores reais com a dos valores previstos, ajudando a ver se o modelo consegue prever a "forma" geral dos dados.

**O que ele mostra:** Duas curvas de densidade, uma para os preços reais e outra para os preços previstos.

```python
# --- Gráfico 3: Gráfico de Distribuição ---
plt.figure(figsize=(10, 6))

# Plotamos a distribuição dos valores reais
sns.kdeplot(y, color='blue', fill=True, label='Valores Reais')

# Plotamos a distribuição dos valores previstos no mesmo gráfico
sns.kdeplot(y_previsto, color='red', fill=True, alpha=0.5, label='Valores Previstos')

plt.title('Distribuição dos Valores Reais vs. Previstos')
plt.xlabel('Preço do Carro ($)')
plt.ylabel('Densidade')
plt.legend()
plt.grid(True)
plt.show()
```

**Interpretação (como na aula):**
O objetivo é que as duas curvas (azul e vermelha) se sobreponham o máximo possível. No nosso caso, elas são bastante parecidas, o que indica que o modelo, apesar de seus defeitos (vistos no gráfico de resíduos), consegue capturar bem a faixa geral de preços. Se a curva vermelha fosse muito diferente (por exemplo, muito mais estreita ou deslocada), isso indicaria que o modelo tem um viés sistemático, como mencionado na aula sobre as previsões imprecisas para carros de $30k a $50k.